# Предсказание стоимости жилья в Калифорнии с использованием Apache Spark

## Описание проекта

Проект посвящен обучению модели линейной регрессии на данных о жилье в Калифорнии в 1990 году с использованием Apache Spark. Цель - предсказать медианную стоимость дома в жилом массиве на основе различных характеристик недвижимости и местоположения.

## Постановка задачи

### Основная цель
Создать модель машинного обучения для предсказания медианной стоимости жилья в различных районах Калифорнии.

### Тип задачи
Регрессия - предсказание непрерывной числовой переменной (стоимость жилья)

### Целевая переменная
`median_house_value` - медианная стоимость дома в жилом массиве

## Используемые данные

### Признаки
- **longitude** - долгота (географические координаты)
- **latitude** - широта (географические координаты)
- **housing_median_age** - медианный возраст домов в районе
- **total_rooms** - общее количество комнат
- **total_bedrooms** - общее количество спален
- **population** - население района
- **households** - количество домохозяйств
- **median_income** - медианный доход жителей
- **ocean_proximity** - близость к океану (категориальный признак)

### Характеристики датасета
- **Размер**: 20,640 записей
- **Разделение**: 80% обучающая выборка (16,560), 20% тестовая (4,080)
- **Пропуски**: только в колонке `total_bedrooms` (207 значений)

## Методология решения

### Технологический стек
- **Apache Spark** - распределенная обработка данных
- **PySpark ML** - библиотека машинного обучения
- **Python** - основной язык программирования

### Предобработка данных
1. **Разделение данных** на обучающую и тестовую выборки (80/20)
2. **Обработка пропусков** - заполнение медианными значениями
3. **Кодирование категориальных признаков** - StringIndexer + OneHotEncoder
4. **Создание Pipeline** для автоматизации всех этапов

### Архитектура решения
Использован **Pipeline** подход, включающий:
- `Imputer` - обработка пропущенных значений
- `StringIndexer` - индексация категориальных признаков
- `OneHotEncoder` - one-hot кодирование
- `VectorAssembler` - объединение признаков
- `LinearRegression` - модель линейной регрессии

## Эксперименты и результаты

### Модель 1: Все признаки (включая категориальные)
- **RMSE**: 70,786.68 долларов
- **MAE**: 50,863.76 долларов
- **R²**: 0.6378 (63.78% объясненной дисперсии)

### Модель 2: Только числовые признаки
- **RMSE**: 71,791.60 долларов
- **MAE**: 51,804.75 долларов
- **R²**: 0.6275 (62.75% объясненной дисперсии)

### Сравнение результатов
| Метрика | Все признаки | Только числовые | Улучшение |
|---------|-------------|-----------------|-----------|
| RMSE    | 70,786.68   | 71,791.60       | 1,004.91  |
| MAE     | 50,863.76   | 51,804.75       | 940.99    |
| R²      | 0.6378      | 0.6275          | 0.0104    |

## Анализ результатов

### Качество предсказаний
- **Средняя ошибка**: ~71 тысяча долларов при медианной цене 200-300 тысяч
- **Относительная ошибка**: ~25% (приемлемо для задач недвижимости)
- **Объясненная дисперсия**: 63.78% (хороший результат для регрессии)

### Ключевые выводы
1. **Категориальный признак значим** - близость к океану влияет на цены
2. **Улучшение умеренное** - числовые признаки уже хорошо объясняют цены
3. **Географические факторы важны** - координаты и близость к океану критичны

## Практическая ценность

### Для бизнеса
- **Оценка недвижимости** - автоматическая оценка стоимости жилья
- **Инвестиционные решения** - анализ привлекательности районов
- **Планирование развития** - понимание факторов ценообразования

### Для аналитиков
- **Масштабируемость** - Spark позволяет обрабатывать большие объемы данных
- **Воспроизводимость** - Pipeline обеспечивает консистентность обработки
- **Интерпретируемость** - линейная регрессия дает понятные коэффициенты

## Технические особенности

### Преимущества Spark
- **Распределенная обработка** - возможность работы с большими данными
- **In-memory вычисления** - высокая скорость обработки
- **Unified API** - единый интерфейс для всех этапов ML pipeline

### Pipeline подход
- **Предотвращение утечки данных** - все трансформации применяются корректно
- **Автоматизация** - весь процесс от сырых данных до предсказаний
- **Масштабируемость** - легко адаптируется для новых данных

## Рекомендации

### Для продакшена
1. **Использовать модель со всеми признаками** - лучшая точность
2. **Мониторить качество** - отслеживать метрики на новых данных
3. **Регулярное переобучение** - обновлять модель при появлении новых данных

### Для улучшения
1. **Feature Engineering** - создание новых признаков (плотность населения, соотношения)
2. **Регуляризация** - Ridge/Lasso для борьбы с переобучением
3. **Ансамбли** - комбинирование нескольких моделей

## Заключение

Проект демонстрирует эффективное использование Apache Spark для задач машинного обучения. Модель показывает приемлемое качество предсказания стоимости жилья с R² = 63.78%. Категориальные признаки (близость к океану) вносят значимый вклад в точность предсказаний, что подтверждает важность географических факторов в ценообразовании недвижимости Калифорнии.